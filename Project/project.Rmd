
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                      echo=FALSE, warning=FALSE, message=FALSE)
```

CAR EDA by Ahmet Hamza Emra
========================================================
Over 370000 used cars scraped with Scrapy from Ebay-Kleinanzeigen. The content of the data is in german, so one has to translate it first if one can not speak german. Those fields are included:

dateCrawled : when this ad was first crawled, all field-values are taken from this date

name : "name" of the car

seller : private or dealer

offerType

price : the price on the ad to sell the car

abtest

vehicleType

yearOfRegistration : at which year the car was first registered

gearbox

powerPS : power of the car in PS

model

kilometer : how many kilometers the car has driven

monthOfRegistration : at which month the car was first registered

fuelType

brand

notRepairedDamage : if the car has a damage which is not repaired yet

dateCreated : the date for which the ad at ebay was created

nrOfPictures : number of pictures in the ad

postalCode

lastSeenOnline : when the crawler saw this ad last online

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.






# load the ggplot graphics package and the others
library(ggplot2)
library(GGally)
library(scales)
library(memisc)
library(ggthemes)
library(RColorBrewer)
library(data.table)
library(lubridate)


```

```{r echo=FALSE, Load_the_Data}
# Load the Data
data<-read.csv("autos.csv")

str(data)


```


## Delete useless columns
```{r}
data$nrOfPictures <- NULL 
data$seller <- NULL
data$offerType <- NULL
data<-subset(data, powerPS<1000)
```




## Format time
```{r}
data$dateCrawled <- ymd_hms(data$dateCrawled)
data$dateCreated <- ymd_hms(data$dateCreated)
data$lastSeen <- ymd_hms(data$lastSeen)
```






```{r}
summary(data)
```


# Univariate Plots Section


### Price 


```{r}
summary(data$price)
```



<p>
as we can see there are a lot of outliers for example, there should not be any car for free and also the upper band is very high. So we need to clean some data.
<p/>
```{r}
data<-subset(data,price<100000)
data<-subset(data,price!=0)
```


```{r}
summary(data$price)
```
still for minimum price 1 is less but lest keep it. there might be a scrap.


```{r echo=FALSE, Univariate_Plots}
ggplot(aes(x=price),data=data)+
  geom_histogram()+
  labs(title='Price Diagram', y = 'number of cars', x='Price')
  

```
```{r}
ggplot(aes(x=price),data=data)+
  geom_histogram()+
  scale_y_log10()
```

### Year of Registration

```{r}
summary(data$yearOfRegistration)
```
also for this column max date can not be after 2016. this is which year data from. also first car ivented at 1885 (whick is still to less but), so there cannot be any thing before that year.

```{r}
data<-subset(data, yearOfRegistration<2016)
data<-subset(data, yearOfRegistration>1950)

```
after cleaning process:
```{r}
summary(data$yearOfRegistration)
```
lets create the histograms:
```{r}
ggplot(data=data,aes(x=yearOfRegistration))+
  geom_histogram()+
  labs(title='Year Of Registration', y = 'number of cars', x='Registration year')
  
```


```{r}
summary(data$vehicleType)
```
```{r}
ggplot(data=subset(data, vehicleType !="") , aes(x=vehicleType))+
  geom_histogram(stat = 'count')
```



I think it is stange that there are more limusine than the other kind of cars.


### Brand


```{r}
summary(data$brand)
```
```{r}
ggplot(data=data,aes(x=brand))+
  geom_histogram(bins = 50,stat='count')+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  labs(x='Brand of Car', y='number of car',title = 'Brad Diagram')
```

\\
volkswagen looks like the most popular car in the market. lets check which kind of volkswagens are in market.

```{r}
ggplot(data=subset(data, brand=="volkswagen"),aes(model))+geom_histogram(stat = 'count')+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

## gear box


```{r}
summary(data$gearbox)
```
```{r}
gearbox_table<-table(subset(data, gearbox!="")$gearbox)

pie(gearbox_table)
```



# Bivariate Plots Section

```{r echo=FALSE}
set.seed(20022012)
datas <- data[sample(1:length(data$price), 10000), ]
datas$name<-NULL
datas$model<-NULL
datas$dateCreated<-NULL
p_ <- GGally::print_if_interactive
pm<-ggpairs(datas,1:8, 
        lower = list(continuous = wrap("points", shape = I('.'))), 
        upper = list(combo = wrap("box", outlier.shape = I('.'))))
p_(pm)

```

\\
as we can see form the table, the corrolation between powerPS and Price is stronger than others. and also there is prity good corrolation number between price and kilometer


```{r echo=FALSE, Bivariate_Plots}
ggplot(data=data,aes(x=yearOfRegistration, y=price))+
  geom_point(fill=I("#F79420"),color=I('black'),shape=21)+
  labs(title='Price & Registration Year')+
  geom_smooth()
```

\\

I was expecting that new cars would have the high price but some of the cars even they are quite antique still have high price. those might be special cars such as classics. 

```{r}
ggplot(data=subset(data,(powerPS!=0)&(powerPS<1000) ),aes(x=powerPS, y=price))+
  geom_point(fill=I("#F79420"),color=I('black'),shape=21)+
  labs(title='Price & PowerPW')+
  geom_smooth(method = 'lm')
```



\\
the relationship between this are very clear as expected. cars with high horse power are most of the time expensive cars. 


```{r}
ggplot(data=data,aes(y=kilometer, x=price))+
  geom_jitter(fill=I("#F79420"),color=I('black'),shape=21)+
  labs(title='Price & kilometer')+
  geom_smooth()
```

\\
I was expecting that when the kilometer is low, pice would be high. but again some cars behave differently. and again those car might be classics. to understand this situation we need to add another veriable. 



# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

ggplot(aes(x=price, y=kilometer,color=gearbox), data = subset(data, gearbox!="") ) + 
  geom_point(alpha=0.5,size=1,position = 'jitter') +
  scale_color_brewer(type='qual', 
                     guide=guide_legend(title = 'Gearbox',
                                                    reverse=TRUE, override.aes = list(alpha=1,size=2)))


```
###   
as we can see in lower costs purple is more intense. So manuel cars are more likely to be cheaper. but for range (2500 to 5000) outomatic cars has the lead. but after arout 50000 the both gearbox type has same behavior.


```{r}
ggplot(aes(x=price, y=kilometer,color=vehicleType), data = subset(data, vehicleType!="") ) + 
  geom_smooth(method = 'auto') +
  scale_color_brewer(type='div', 
                     guide=guide_legend(title = 'Vehicle Types',
                                                    reverse=TRUE, override.aes = list(alpha=1,size=2)))
```


##    
kleinwagen model cars are small and has small engine. so that It is not a suprise that they are cheap. also the andre is german word for other. So there is a lot of car models can be in that category. it is hard to trust that line since we dont know what kind a car it is. 

```{r}

ggplot(aes(x=price, y=kilometer,color=fuelType), data = subset(data, fuelType!="") ) + 
  geom_point(size=1,position = 'jitter') +
  scale_color_brewer(type='qual', 
                     guide=guide_legend(title = 'fuel type',
                                                    reverse=TRUE, override.aes = list(alpha=1,size=2)))

```


# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

I commend them under the plots. 

### Were there any interesting or surprising interactions between features?
Since benzin is expencive in europe, i was expecting disel cars to be cheper. but for same kilometer almost allways diesel is expensive. 

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}
library(corrplot)
datas$dateCrawled<-NULL
datas$abtest<-NULL
datas$vehicleType<-NULL
datas$gearbox<-NULL
datas$monthOfRegistration<-NULL
datas$fuelType<-NULL
datas$notRepairedDamage<-NULL
datas$lastSeen<-NULL
datas$brand<-NULL
datas$postalCode<-NULL

corrplot.mixed(cor(datas))
```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
